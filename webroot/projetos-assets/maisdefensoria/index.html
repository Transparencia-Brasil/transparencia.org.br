<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mais Defensoria</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />

    <link rel="icon" type="image/x-icon" href="./style/img/favicon.ico" />
    <link rel="stylesheet" href="./style/styles.css" />

    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>
  <body>
    <div class="maisdef-container">
      <nav class="navbar">
        <div class="container-fluid">
          <button
            class="maisdef-open-drawer"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasNavbar"
            aria-controls="offcanvasNavbar"
            aria-label="Toggle navigation"
          >
            <div class="maisdef-hamburguer-menu">
              <i class="material-icons menu-icon"> menu </i>
            </div>
          </button>
          <img
            class="maisdef-logo-small"
            src="./style/img/logo_maisdef.png"
            alt="Logo"
          />
          <div
            class="offcanvas offcanvas-start"
            tabindex="-1"
            id="offcanvasNavbar"
            aria-labelledby="offcanvasNavbarLabel"
          >
            <div class="offcanvas-header">
              <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Menu</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="offcanvas"
                aria-label="Close"
              ></button>
            </div>
            <div class="offcanvas-body">
              <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                <li class="nav-item">
                  <a class="nav-link active active" aria-current="page" href="#"
                    >O MAIS DEFENSORIA</a
                  >
                </li>
                <li class="nav-item">
                  <a class="nav-link active" href="#">Produtos</a>
                </li>
                <li class="nav-item dropdown dropdown-center">
                  <a
                    class="maisdef-dropdown-item nav-link active dropdown-toggle"
                    role="button"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                    data-bs-auto-close="outside"
                  >
                    Relatórios
                  </a>
                  <ul class="dropdown-menu">
                    <li>
                      <a class="dropdown-item" href="#"
                        >Revisão dos Critérios</a
                      >
                    </li>
                    <li>
                      <a class="dropdown-item" href="#"
                        >Performance das Ouvidorias</a
                      >
                    </li>
                    <li>
                      <a
                        target="_blank"
                        class="dropdown-item"
                        href="https://www.transparencia.org.br/downloads/publicacoes/transparnciaativadoscritriosdeatendimentodasdefensorias.pdf"
                        >Transparência Ativa</a
                      >
                    </li>
                    <li>
                      <a
                        target="_blank"
                        class="dropdown-item"
                        href="https://www.transparencia.org.br/downloads/publicacoes/transparnciapassivadasdefensoriaspblicas.pdf"
                        >Canais de Transparência</a
                      >
                    </li>
                  </ul>
                </li>
                <li class="nav-item">
                  <a class="nav-link active" href="#">Notícias</a>
                </li>
                <li class="nav-item">
                  <a
                    class="nav-link active"
                    data-bs-dismiss="offcanvas"
                    onclick="goToPartners()"
                    >Parceiros</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </div>
      </nav>

      <nav class="maisdef-nav">
        <ul class="maisdef-nav-list">
          <li><a href="#" class="green-color">O MAIS DEFENSORIA</a></li>
          <li><a href="#">Produtos</a></li>
          <li class="nav-item dropdown dropdown-center">
            <a
              class="nav-link dropdown-toggle"
              href="#"
              role="button"
              data-bs-toggle="dropdown"
              aria-expanded="false"
              data-bs-auto-close="outside"
            >
              Publicações
            </a>
            <ul class="dropdown-menu">
              <li class="maisdef-dropdown-item nav-item dropdown dropend">
                <a
                  class="maisdef-dropdown-item dropdown-item nav-link dropdown-toggle"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                  data-bs-auto-close="outside"
                >
                  Relatórios
                </a>
                <ul class="dropdown-menu">
                  <li>
                    <a class="dropdown-item" href="#">Revisão dos Critérios</a>
                  </li>
                  <li>
                    <a class="dropdown-item" href="#"
                      >Performance das Ouvidorias
                    </a>
                  </li>
                  <li>
                    <a
                      target="_blank"
                      class="dropdown-item"
                      href="https://www.transparencia.org.br/downloads/publicacoes/transparnciaativadoscritriosdeatendimentodasdefensorias.pdf"
                      >Transparência Ativa</a
                    >
                  </li>
                  <li>
                    <a
                      target="_blank"
                      class="dropdown-item"
                      href="https://www.transparencia.org.br/downloads/publicacoes/transparnciapassivadasdefensoriaspblicas.pdf"
                      >Canais de Transparência
                    </a>
                  </li>
                </ul>
              </li>
              <li>
                <a class="maisdef-dropdown-item dropdown-item" href="#"
                  >Notícias</a
                >
              </li>
            </ul>
          </li>
          <li><a href="#parceiros">Parceiros</a></li>
          <img
            class="maisdef-logo"
            src="./style/img/logo_maisdef.png"
            alt="Logo"
          />
        </ul>
      </nav>
      <section class="maisdef-home-section">
        <div class="maisdef-home">
          <div class="maisdef-text-home">
            <h1>
              A <span class="maisdef-greenscale">justiça</span> <br /> <span class="maisdef-greenscale">inclusiva</span> e
              <span class="maisdef-greenscale">equitativa</span>
            </h1>
            <div class="maisdef-home-content">
              <p>
                O projeto Mais Defensoria tem o propósito de ampliar o acesso à Justiça, principalmente por cidadãos mais marginalizados.
                <br />
                <br />
                Nosso foco é melhorar a governança das Defensorias Públicas do país, por meio do fornecimento de informações e dados sobre 
                os problemas de acesso ao sistema de justiça e criação de ferramentas para fortalecer a administração dos órgãos.
              </p>
              <img src="./style/img/home-section-pic.svg" alt="ilustração">
            </div>
          </div>
        </div>
      </section>
      <section>
        <div class="maisdef-text-classification">
          <div class="maisdef-text-classification-p">
            <h2 style="color: #4f6f52;">Avaliamos e classificamos a transparência dos critérios de atendimento das Defensorias Públicas em todo país</h2>
            <h2 class="maisdef-text-ava">
              Com base nas avaliações feitas pelo projeto Mais Defensoria, 
              <span>93%</span> das 28 Defensorias Públicas <span>apresentaram falhas de transparência</span> sobre os critérios de
                elegibilidade para atendimento.
              
            </h2>
            <h4 class="maisdef-relatorio-link">Relatório:
              <a href="https://www.transparencia.org.br/downloads/publicacoes/transparnciaativadoscritriosdeatendimentodasdefensorias.pdf" target="_blank">
              Transparência dos critérios para atendimento das defensorias públicas
              </a>
          </h4>
          </div>
          <div class="maisdef-text-classification-dataviz">
            <h4 class="maisdef-text-classification-header">Classificação de Transparência de critérios de elegibilidade por estado</h4>
            <p id="maisdef-graph-text" style="text-align: center;"></p>
            <div id="dataviz">
              <div>
                <div class="maisdef-change-data-btn" title="Mudar avaliação" data-bs-toggle="tooltip" data-bs-title="Alterne entre as avaliações">
                  <svg onclick="handleDataViz()" xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-chevron-left" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M11.354 1.646a.5.5 0 0 1 0 .708L5.707 8l5.647 5.646a.5.5 0 0 1-.708.708l-6-6a.5.5 0 0 1 0-.708l6-6a.5.5 0 0 1 .708 0"/>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <section class="maisdef-green-section">
        <div class="maisdef-text-transparency-analisys">
          <div class="maisdef-split-content">
            <div>
              <div class="maisdef-bar">
              </div>
              <div class="maisdef-avalidados">
                No site de cada Defensoria Pública, avaliamos:
                <ul style="margin-top: 1rem; line-height: 35px;">
                  <li>
                    A <b>disponibilidade</b> e <b>clareza</b> dos critérios
                  </li>
                  <li>
                    O <b>nível de completude</b> e <b>integridade</b> da informação
                  </li>
                  <li>
                    O <b>grau de detalhamento</b> das descrições
                  </li>
                  <li>
                    <b>Menção e referência</b> à regulação 
                  </li>
                  <li>
                    <b>Acessibilidade</b> das informações
                  </li>
                </ul>
              </div>
               <h2 class="maisdef-saiba-mais">
                Os órgãos se mostraram dispostos a entender quais eram as falhas e 
                solucioná-las, compreendendo a relação entre uma melhor transparência 
                e a missão da instituição de garantir o acesso à justiça.
                </h2>
            </div>
            <div style="display: flex; flex-direction: column; align-items: center; color: #fbc02d;">
              <h2>Analisamos a
                transparência
                ativa</h2>
              <a href="https://www.transparencia.org.br/downloads/publicacoes/reavaliacao_transparencia_criterios_defensorias.pdf" target="_blank" style="color: #fff; text-decoration: underline; margin: 2rem 0 2rem 0;">Relatório de transparência ativa</a>
              <img src="./style/img/undraw_women.svg" alt="chart women" />
            </div>
          </div>
        </div>
      </section>
      <section>
        <div class="maisdef-text-partners" id="parceiros">
          <div>
            <h2>Parceiros</h2>
            <div>
              <img src="./style/img/CONDEGE_LOGO.png" alt="logo Condege" />
              <img
                src="./style/img/conselho_ouvidorias.png"
                alt="logo conselho nacional de ouvidorias"
              />
            </div>
          </div>
          <div>
            <h2>Financiador</h2>
            <div class="maisdef-logo_section">
              <img src="./style/img/Tinker-Logo-Final1.svg" alt="logo Tinker" />
            </div>
          </div>
      </section>
    </div>
  

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>

    <script>
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))

      function goToPartners() {
        setTimeout(function () {
          window.location.href = "#parceiros";
        }, 800);
      }
    </script>

    <script>
      const graphText = document.getElementById("maisdef-graph-text")

      const transparencyMetrics = [
        { transparency: "Sem transparência", color: "#EDF8FB" },
        { transparency: "Baixíssima transparência", color: "#B2E2E2" },
        { transparency: "Baixa transparência", color: "#66C2A4" },
        { transparency: "Média transparência", color: "#2CA25F" },
        { transparency: "Alta transparência", color: "#006D2C" },
      ];

      let dataType = "AV1"
      graphText.innerText = "Primeira avaliação de Transparência"

      function handleDataViz() {
        dataType = dataType === "AV1" ? "AV2" : "AV1";

        // Animação de fade-in e fade-out
        graphText.classList.add("fade-in");

        setTimeout(function () {
          graphText.innerText = dataType === "AV1" ? "Primeira avaliação de Transparência" : "Reavaliação de transparência";
        }, 500);

        setTimeout(function () {
          graphText.classList.remove("fade-in");
        }, 500);

        // Atualizar o preenchimento dos estados de acordo com o novo tipo de dado
        svg
          .selectAll("path")
          .transition()
          .duration(500)
          .style("fill", function (d) {
          return transparencyMetrics[d.properties[dataType]].color;
        });
      }

      // Código JavaScript usando D3.js para desenhar um mapa com todos os estados do Brasil
      const responsive = (big, small) =>{
        return window.innerWidth > 550 ? big : small
      }

      var width = responsive(450, window.innerWidth - 70)
      var height = width;
      var scale = width * 1.372;

      var svg = d3
      .select("#dataviz")
      .append("svg")
      .attr("width", width)
      .attr("height", height);

      var projection = d3
      .geoMercator()
      .center([-55, -15])
      .scale(scale)
      .translate([width / 2, height / 2]);

      var path = d3.geoPath().projection(projection);

      var tooltip = d3
      .select("#dataviz")
      .append("div")
      .attr("class", "graph-tooltip")
      .style("opacity", 0);

      // Carregar o arquivo GeoJSON
      d3.json("./data/brasil.json").then(function (data) {
      // Desenhar os estados
      svg
        .selectAll("path")
        .data(data.features)
        .enter()
        .append("path")
        .attr("d", path)
        .style("fill", function (d) {
          // Preencher cada estado com uma cor diferente
          return transparencyMetrics[d.properties[dataType]].color;
        })
        .style("stroke", "black")
        .style("stroke-width", 0.4)
        .on("mousemove", function (event, d) {
        let [x, y] = d3.pointer(event);
        tooltip.transition().duration(200).style("opacity", 0.9);
        tooltip
          .html(
            d.properties.NOME_UF +
            ": " +
            transparencyMetrics[d.properties[dataType]].transparency
          ) // Adiciona o nome do estado ao tooltip
          .style("left", x - 70 + "px")
          .style("top", y - 50 + "px")
          .style("font-size", `${responsive(14, 12)}px`);
        })
        .on("mouseout", function (d) {
          // Adiciona o evento de mouseout
          tooltip.transition().duration(200).style("opacity", 0);
        });

      // Adicionar a sigla dos estados
      svg
        .selectAll(".state-label")
        .data(data.features)
        .enter()
        .append("text")
        .attr("class", "state-label")
        .attr("transform", function (d) {
          // Encontra o centro do estado para posicionar o texto
          var center = path.centroid(d);
          center[1] += 4; // Adiciona 4 pixels para baixo [y]
          return "translate(" + center + ")";
        })
        .text(function (d) {
          return d.properties.UF; // Obtém a sigla do estado
        })
        .style("pointer-events", "none") // Impede que o evento de mouseover seja ativado no texto
        .style("font-weight", "normal")
        .style("font-size", `${responsive(12, 10)}px`)

      // Adicionar a legenda de cores
      var legend = svg
        .selectAll(".legend")
        .data(transparencyMetrics)
        .enter()
        .append("g")
        .attr("class", "legend")
        .attr("transform", function (d, i) {
          var legendX = width - responsive(450, 340);
          var legendY = height - 135 + i * 29;
          return "translate(" + legendX + "," + legendY + ")";
        });

      legend
        .append("rect")
        .attr("width", 18)
        .attr("height", 18)
        .style("fill", function (d) {
          return d.color;
        });

      legend
        .append("text")
        .attr("x", 24)
        .attr("y", 9)
        .attr("dy", ".35em")
        .text(function (d) {
          return d.transparency;
        })
        .style("font-size", `${responsive(14, 10)}px`)
        .style("font-weight", "600");
      });
    </script>
  </body>
</html>
